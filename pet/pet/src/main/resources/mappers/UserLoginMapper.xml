<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.diamondboss.user.repository.UserLoginMapper" >

	<!-- 登录查询  -->
	<select id="queryUserLoginByPhone"
		parameterType="java.lang.String"
		resultType="com.diamondboss.user.pojo.UserLoginPojo">
		SELECT
		  A.id AS id,
		  A.phone_number AS phoneNumber,
		  B.name AS name
		FROM
		    user_login A
		INNER JOIN user_info B ON A.id = B.user_id
		WHERE
			A.phone_number = #{phoneNumber}
			AND A.effective = '1'
	</select>

	<!-- 登录插入 -->
	<insert id="insertUserLoginByPhone" parameterType="java.lang.String">
		INSERT
		INTO
		    user_login
		    (
		        phone_number,
		        order_num,
		        order_total,
		        effective
		    )
		    VALUES
		    (
		        #{phoneNumber},
		        0,
		        0,
		        '1'
		    );
	</insert>

</mapper>